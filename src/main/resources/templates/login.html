<!doctype html>

<html class="no-js" lang="en" xmlns:th="http://www.thymeleaf.org">

    <div th:replace="shared/head :: head"></div>

<body class="bg-dark">

    <div class="sufee-login d-flex align-content-center flex-wrap">
        <div class="container">
            <div class="login-content">
                <div class="login-logo">
                    <a href="#">
                        <h2 style="color: whitesmoke;">Smart Parking</h2>
                    </a>
                </div>
                <div class="login-form">
                    <form th:action="@{/login.html}" method="post">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="email" class="form-control" placeholder="Email">
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="password" class="form-control" placeholder="Password">
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox"> Remember Me
                            </label>
                            <label class="pull-right">
                                <a href="#">Forgot password?</a>
                            </label>
                        </div>
                        <!--<a th:href="@{/login}">-->
                        <button id="btnLogin" type="button" class="btn btn-success btn-flat m-b-30 m-t-30">
                            Log in
                        </button>
                        <!--</a>-->
                        <div class="register-link m-t-15 text-center">
                            <p>Don't have an account? <a href="#">Contact us!</a></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="/vendors/jquery/dist/jquery.min.js"></script>
    <script src="/vendors/popper.js/dist/umd/popper.min.js"></script>
    <script src="/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="/assets/js/main.js"></script>
    <script src="/js/app.js"></script>

</body>
    <script> //cái script này lúc nào cũng phải để dưới cuối cùng, sau tất cả các lệnh import script khác

    ready(function () {
        document.getElementById("btnLogin").addEventListener("click", function () {
            loginAccount();
        });
        //chỗ này mai mốt bind listener cho element nào thì làm ở đây
    });

    function loginAccount() {
        let email = document.getElementById("email").value;
        let password = document.getElementById("password").value;

        CallAjaxWithFetch(`/account/login`,
            "POST",
            {email, password},
            (data) => {
                if (data.status === true) {
                    // alert(data.message);
                    window.jwtTokenGlobalVariable = data.objectResponse;
                    window.location.href = "/home";
                }
                if (data.status === false) {
                    // alert(data.message);
                }
            },
            (err) => {
                //alert(err.message);
            }
        );
    }

    </script>
</html>