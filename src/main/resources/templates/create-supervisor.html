<!doctype html>

<html class="no-js" lang="en" xmlns:th="http://www.thymeleaf.org">

<div th:replace="shared/head :: head"></div>

<body>
    <div th:replace="shared/left_panel :: left_panel"></div>

    <div id="right-panel" class="right-panel">

        <div th:replace="shared/header :: header"></div>

        <div th:replace="shared/breadcrumbs :: breadcrumbs"></div>

        <div class="col-lg-6">
        <div class="card">
            <div class="card-header"><b>Supervisor</b></div>
            <div class="card-body card-block">
                <div class="form-group col-lg-6">
                    <label for="firstName" class=" form-control-label">First name</label>
                    <input type="text" id="firstName" placeholder="First name" class="form-control" required/>
                </div>
                <div class="form-group col-lg-6">
                    <label for="lastName" class=" form-control-label">Last name</label>
                    <input type="text" id="lastName" placeholder="Last name" class="form-control" required/>
                </div>
                <div class="form-group">
                    <label for="email" class="form-control-label">Email</label>
                    <input type="email" id="email" placeholder="Email" class="form-control" required/>
                </div>
                <div class="form-group">
                    <label for="phone" class=" form-control-label">Phone number</label>
                    <input type="tel" id="phone" placeholder="Phone Number" class="form-control" required/>
                </div>
            </div>
            <div class="card-footer">
                <button type="reset" class="btn btn-danger float-left">
                    <i class="fa fa-ban"></i> Reset
                </button>
                <button id="btnCreate" type="button" class="btn btn-primary float-right">
                    <i class="fa fa-check"></i> Create
                </button>
            </div>
        </div>
    </div>
    </div>

    <script src="/vendors/jquery/dist/jquery.min.js"></script>
    <script src="/vendors/popper.js/dist/umd/popper.min.js"></script>
    <script src="/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="/assets/js/main.js"></script>
    <script src="/js/app.js"></script>

    <script src="/vendors/jqvmap/dist/jquery.vmap.min.js"></script>
    <script src="/vendors/jqvmap/examples/js/jquery.vmap.sampledata.js"></script>
    <script src="/vendors/jqvmap/dist/maps/jquery.vmap.world.js"></script>

</body>
<script>

    ready(function () {
        document.getElementById("btnCreate").addEventListener("click", function () {
            createAccount();
        });

        //chỗ này mai mốt bind listener cho element nào thì làm ở đây
    });

    function createAccount() {
        let firstName = document.getElementById("firstName").value;
        let lastName = document.getElementById("lastName").value;
        let email = document.getElementById("email").value;
        let phoneNumber = document.getElementById("phone").value;
        let roleId = 2;

        CallAjaxWithFetch(`/account/register`,
            "POST",
            { firstName, lastName, email, phoneNumber, roleId },
            (data) => {
                showAlert(true, data.message);
                document.location.href = "/list-supervisors";
            },
            (err) => {
                showAlert(false, err.message);
            }
        )
    }

    function validateInput() {
        let validateMessage = '';

        let firstName = $("#firstName").val().trim();
        let lastName = $("#lastName").val().trim();
        let phoneNumber = $("#phone").val().trim();
        let email = $("#email").val().trim();

        let intRegex = /\d+/;
        let phoneRegex = /0\d{9}/;

        if (firstName.length === 0 ) {
            validateMessage = 'First Name is required!';
        } else if (lastName.length === 0) {
            validateMessage = 'Last Name is required';
        } else if (email.length === 0) {
            validateMessage = 'Email is required';
        } else if (!phoneRegex.test(phoneNumber)) {
            validateMessage = 'Phone number should follow format 0#########';
        }

        if (validateMessage.length) {
            showAlert(false, validateMessage);
            return null;
        }

        return {
            firstName: firstName,
            lastName: lastName,
            email: email,
            phoneNumber: phoneNumber,
        }
    }

    function resetInput() {
        document.getElementById("firstName").value = '';
        document.getElementById("lastName").value = '';
        document.getElementById("email").value = '';
        document.getElementById("phone").value = '';
    }

</script>
</html>